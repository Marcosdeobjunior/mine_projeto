<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus C√≥smico - Gerador de Poderes</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        :root {
            --bg-color: #0d0f18; --card-bg-color: rgba(23, 22, 36, 0.7); --primary-glow: #7b2cbf;
            --secondary-glow: #2c73bf; --text-color: #e2e8f0; --text-muted: #94a3b8;
            --border-color: rgba(123, 44, 191, 0.3); --success-color: #10b981; --danger-color: #ef4444;
        }

        *, *::before, *::after { box-sizing: border-box; }

        body {
            font-family: 'Poppins', sans-serif; background-color: var(--bg-color); color: var(--text-color);
            margin: 0; padding: 2rem; overflow-x: hidden; position: relative;
        }

        body::before {
            content: ''; position: fixed; top: -50%; left: -50%; width: 200%; height: 200%;
            background-image: 
                radial-gradient(circle at 20% 20%, var(--primary-glow), transparent 30%),
                radial-gradient(circle at 80% 70%, var(--secondary-glow), transparent 30%);
            background-color: var(--bg-color); will-change: transform; z-index: -1;
            animation: gradient-move 20s ease-in-out infinite alternate;
        }

        @keyframes gradient-move { 0% { transform: translate(0, 0) rotate(0deg); } 100% { transform: translate(10%, 20%) rotate(10deg); } }

        .header { text-align: center; margin-bottom: 2rem; }
        .header h1 {
            font-family: 'Orbitron', sans-serif; color: white; font-size: 3rem; letter-spacing: 2px;
            text-shadow: 0 0 10px var(--primary-glow), 0 0 20px var(--primary-glow); margin: 0;
        }

        .container { width: 100%; max-width: 1400px; margin: 0 auto; text-align: center; }
        p.subtitle { font-size: 1.1rem; color: var(--text-muted); margin-bottom: 2.5rem; }
        
        .controls { display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 1.5rem; margin-bottom: 2.5rem; }
        .btn {
            font-family: 'Orbitron', sans-serif; color: white; border: 1px solid transparent; padding: 12px 24px;
            font-size: 1rem; border-radius: 50px; cursor: pointer; transition: all 0.3s ease;
            background-color: rgba(255, 255, 255, 0.05); backdrop-filter: blur(5px);
        }
        #generate-btn { border-color: var(--primary-glow); } #generate-btn:hover { background-color: var(--primary-glow); box-shadow: 0 0 20px var(--primary-glow); }
        #battle-btn, #arena-battle-btn { border-color: #f9d423; display: none; } #battle-btn:hover, #arena-battle-btn:hover { background-color: #f9d423; box-shadow: 0 0 20px #f9d423; }
        #arena-battle-btn { margin-top: 1.5rem; }
        #arena-battle-btn:disabled { cursor: not-allowed; opacity: 0.5; }
        #view-toggle-btn { border-color: var(--text-muted); } #view-toggle-btn:hover { background-color: var(--text-muted); color: var(--bg-color); }
        
        .theme-selector-wrapper { display: flex; align-items: center; gap: 0.5rem; }
        #theme-selector {
            font-family: 'Poppins', sans-serif; background-color: transparent; color: var(--text-color);
            border: 1px solid var(--border-color); border-radius: 8px; padding: 10px; font-size: 1rem; cursor: pointer;
        }
        #theme-selector option { background-color: var(--bg-color); color: var(--text-color); }

        .main-content { display: block; } .main-content.hidden { display: none; }
        #results-container { display: flex; gap: 2rem; justify-content: center; align-items: stretch; width: 100%; }
        .power-card {
            background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 16px;
            padding: 1.5rem 2rem 2rem 2rem; text-align: left; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            flex: 1; display: flex; flex-direction: column; backdrop-filter: blur(10px);
        }
        .power-header { text-align: center; margin-bottom: 1.5rem; position: relative; }
        .power-name { font-family: 'Orbitron', sans-serif; color: white; margin: 0 0 0.5rem 0; font-size: 1.8rem; }
        .power-narrative { border-left: 3px solid var(--primary-glow); padding-left: 1rem; margin-bottom: 1rem; }
        .power-narrative p { margin: 0.5rem 0; text-align: left; line-height: 1.6; }
        .power-narrative strong { color: white; }
        
        .tier-badge { display: inline-block; font-family: 'Orbitron', sans-serif; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.9rem; color: white; font-weight: bold; }
        .tier-extremo { background-color: #ef4444; box-shadow: 0 0 10px #ef4444; } .tier-cosmico { background-color: #a855f7; box-shadow: 0 0 10px #a855f7; }
        .tier-elevado { background-color: #3b82f6; box-shadow: 0 0 10px #3b82f6; } .tier-controlavel { background-color: #06b6d4; box-shadow: 0 0 10px #06b6d4; }
        .tier-baixo { background-color: #22c55e; box-shadow: 0 0 10px #22c55e; }
        .power-score { font-size: 0.9rem; color: var(--text-muted); margin-top: 0.5rem; font-weight: bold; }

        h3 { font-family: 'Orbitron', sans-serif; color: white; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem; margin-top: 2rem; }
        ul { list-style: none; padding: 0; }
        li { background-color: rgba(0,0,0,0.2); padding: 1rem; margin-bottom: 0.5rem; border-radius: 8px; line-height: 1.5; }
        li strong { color: white; display: block; margin-bottom: 0.25rem; font-weight: 600; }

        .card-footer { margin-top: auto; padding-top: 1.5rem; text-align: center; }
        .action-icon { background-color: transparent; border: 1px solid var(--text-muted); color: var(--text-muted); border-radius: 50%; width: 40px; height: 40px; cursor: pointer; transition: all 0.3s; margin: 0 0.5rem; }
        .action-icon:hover { color: white; }
        .action-icon.save-btn:hover { border-color: var(--success-color); background-color: var(--success-color); }
        .action-icon.share-btn:hover { border-color: var(--secondary-glow); background-color: var(--secondary-glow); }
        .save-btn:disabled { background-color: var(--success-color); color: white; opacity: 0.7; cursor: not-allowed; }

        #saved-powers-section { width: 100%; margin-top: 4rem; }
        #saved-filters { display: flex; flex-wrap: wrap; gap: 1rem; justify-content: center; margin-bottom: 2rem; align-items: center; }
        #search-saved { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 20px; padding: 10px 15px; color: white; font-size: 1rem; }
        .filter-btn { background: none; border: 1px solid var(--border-color); color: var(--text-muted); padding: 8px 16px; border-radius: 20px; cursor: pointer; transition: all 0.3s ease; }
        .filter-btn.active, .filter-btn:hover { color: white; background-color: var(--primary-glow); border-color: var(--primary-glow); }

        #saved-powers-container, #arena-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem; }
        .saved-power-card {
            background-color: var(--card-bg-color); backdrop-filter: blur(5px); border-radius: 8px; padding: 1rem;
            display: flex; justify-content: space-between; align-items: center; border-left: 4px solid;
            cursor: pointer; transition: all 0.3s ease; position: relative;
        }
        .saved-power-card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.3); }
        #arena-container .saved-power-card.selected { box-shadow: 0 0 15px var(--secondary-glow); border-color: var(--secondary-glow); }

        .saved-power-card .info { text-align: left; } .saved-power-card .name { font-weight: 600; font-size: 1.1rem; color: white; }
        .saved-power-card .delete-btn {
            position: absolute; top: 5px; right: 5px; background-color: transparent; border: none; color: var(--text-muted);
            width: 28px; height: 28px; border-radius: 50%; cursor: pointer; transition: all 0.3s; font-size: 0.9rem; z-index: 5;
        }
        .saved-power-card:hover .delete-btn { background-color: var(--danger-color); color: white; }
        
        .modal {
            display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%;
            overflow: auto; background-color: rgba(0,0,0,0.6); backdrop-filter: blur(10px);
            opacity: 0; transition: opacity 0.3s ease;
        }
        .modal.visible { display: flex; opacity: 1; }
        .modal-content {
            background-color: var(--card-bg-color); margin: auto; padding: 2rem; border: 1px solid var(--border-color);
            width: 90%; max-width: 800px; border-radius: 16px; text-align: center; position: relative;
            transform: scale(0.95); transition: transform 0.3s ease; max-height: 90vh; overflow-y: auto;
        }
        .modal.visible .modal-content { transform: scale(1); }
        .close-btn { color: #aaa; position: absolute; top: 1rem; right: 1.5rem; font-size: 28px; font-weight: bold; cursor: pointer; }
        
        #battle-log-container { text-align: left; margin-top: 2rem; }
        #battle-log-container h3 { margin-top: 0; }
        #battle-log-list { list-style: none; padding: 0; }
        #battle-log-list li { margin-bottom: 1rem; padding-left: 1.5rem; border-left: 3px solid var(--border-color); }
        #battle-log-list li strong { font-family: 'Orbitron'; font-size: 1.1rem; }
        
        .placeholder-text { color: var(--text-muted); font-style: italic; align-self: center; margin-top: 4rem; }
        .footer { margin-top: 4rem; padding-top: 2rem; border-top: 1px solid var(--border-color); text-align: center; color: var(--text-muted); font-size: 0.9rem; }
        
        /* Melhorias para a se√ß√£o de poderes salvos */
        .saved-powers-empty {
            text-align: center;
            color: var(--text-muted);
            font-style: italic;
            padding: 3rem;
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            margin-top: 2rem;
        }
        
        .saved-power-card .tier-info {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }
        
        .saved-power-card .view-details-btn {
            background-color: var(--primary-glow);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 1rem;
        }
        
        .saved-power-card .view-details-btn:hover {
            background-color: var(--secondary-glow);
            transform: scale(1.05);
        }
        
        @media (max-width: 900px) { #results-container { flex-direction: column; } }
    </style>
</head>
<body>
    <header class="header"><h1>NEXUS C√ìSMICO</h1></header>

    <div class="container">
        <p class="subtitle">Forje, salve e simule batalhas entre for√ßas de m√∫ltiplos universos.</p>
        
        <div class="controls">
            <button id="view-toggle-btn" class="btn"><i class="fas fa-shield-alt"></i> Ir para Arena</button>
            <div class="theme-selector-wrapper">
                <label for="theme-selector"><i class="fas fa-palette"></i> Tema:</label>
                <select id="theme-selector"></select>
            </div>
            <button id="generate-btn" class="btn"><i class="fas fa-dice-d20"></i> Gerar Poderes</button>
        </div>

        <div id="generator-view" class="main-content">
            <div id="battle-btn-container" class="action-buttons">
                <button id="battle-btn" class="btn"><i class="fas fa-khanda"></i> Batalhar Gerados</button>
            </div>
            <div id="results-container">
                <div class="power-card" id="power-card-1"><p class="placeholder-text">Aguardando a manifesta√ß√£o do primeiro poder...</p></div>
                <div class="power-card" id="power-card-2"><p class="placeholder-text">O segundo poder aguarda o chamado do v√°cuo...</p></div>
            </div>
        </div>

        <div id="arena-view" class="main-content hidden">
            <h2>Arena dos Salvos</h2>
            <p class="subtitle">Selecione dois dos seus poderes salvos para um confronto √©pico.</p>
            <div id="arena-container"></div>
            <div class="action-buttons">
                <button id="arena-battle-btn" class="btn" disabled><i class="fas fa-khanda"></i> Iniciar Batalha na Arena</button>
            </div>
        </div>

        <section id="saved-powers-section">
            <h2>Poderes Salvos</h2>
            <div id="saved-filters">
                <input type="search" id="search-saved" placeholder="Buscar pelo nome...">
                <button class="filter-btn active" data-filter="all">Todos</button>
            </div>
            <div id="saved-powers-container"></div>
        </section>
    </div>

    <div id="main-modal" class="modal"><div class="modal-content" id="modal-content-area"></div></div>

    <footer class="footer"><p>&copy; 2025 Nexus C√≥smico. O universo em suas m√£os.</p></footer>

    <script>
        // JAVASCRIPT COMPLETO COM MELHORIAS
        const allData = {
            cosmico: {
                names: ["Singularidade Harm√¥nica", "Nexo Gravitacional", "Cora√ß√£o da Supernova", "Eco do Vazio", "Coroa da Antimat√©ria", "Pulso de N√™utrons"],
                origins: ["Nascido do colapso de uma estrela massiva, este poder concede dom√≠nio sobre as for√ßas que regem massa e espa√ßo.", "O portador se torna um canal para a energia do v√°cuo, a for√ßa primordial que existe entre as gal√°xias.", "Fragmento senciente do Big Bang, este poder permite reescrever as leis da f√≠sica em uma √°rea limitada.", "Esta for√ßa √© a manifesta√ß√£o da entropia controlada, capaz de acelerar ou reverter o decaimento do universo."],
                consequences: ["Seu uso constante deixa ecos no espa√ßo-tempo, atraindo a aten√ß√£o de entidades extradimensionais.", "O portador lentamente se desassocia da realidade f√≠sica, tornando-se mais uma ideia do que um ser.", "A cada uso, uma pequena parte da realidade √© permanentemente 'gasta', com efeitos imprevis√≠veis a longo prazo.", "O usu√°rio ouve constantemente os sussurros de futuros poss√≠veis e passados desfeitos, beirando a insanidade."],
                abilities: [
                    { name: "Manipula√ß√£o Gravitacional", description: "Altera a atra√ß√£o de objetos, criando po√ßos de gravidade ou anular o peso.", score: 9, tags: ['fisica', 'controle', 'ofensiva'] },
                    { name: "Dobra da Realidade Local", description: "Reescreve as leis da f√≠sica em uma √°rea, fazendo o fogo congelar ou o espa√ßo se curvar.", score: 10, tags: ['realidade', 'controle', 'defensiva'] },
                    { name: "Explos√£o de Supernova", description: "Libera uma explos√£o de energia com o poder de uma estrela em colapso.", score: 10, tags: ['energia', 'ofensiva', 'area'] },
                    { name: "Imunidade Temporal", description: "Existe fora do fluxo normal do tempo, imune a paradoxos e altera√ß√µes temporais.", score: 8, tags: ['temporal', 'defensiva', 'passiva'] },
                    { name: "Cria√ß√£o de Mat√©ria do V√°cuo", description: "Manifesta construtos de mat√©ria e energia a partir do nada.", score: 8, tags: ['materia', 'cria√ß√£o', 'versatil'] },
                    { name: "Controle sobre Mat√©ria Escura", description: "Manipula a mat√©ria escura para criar campos de for√ßa impenetr√°veis ou se tornar indetect√°vel.", score: 7, tags: ['materia', 'defensiva', 'furtiva'] }
                ],
                weaknesses: [
                    { name: "Vulnerabilidade a Caos", description: "Energias imprevis√≠veis corrompem o controle do portador, tornando seus poderes perigosos.", score: -8, tags: ['vulnerabilidade_caos'] },
                    { name: "Ancora Mortal", description: "Possui uma conex√£o com um objeto ou pessoa mortal. Se a √¢ncora for destru√≠da, o poder enfraquece drasticamente.", score: -9, tags: ['vulnerabilidade_psicologica'] },
                    { name: "Atra√ß√£o de Entidades", description: "O uso do poder emite uma 'assinatura', atraindo a aten√ß√£o de predadores c√≥smicos.", score: -7, tags: ['passiva_negativa'] },
                    { name: "Vulnerabilidade ao V√°cuo Absoluto", description: "Em uma zona de 'ponto nulo', sem energia ou vibra√ß√µes, o poder se torna inerte.", score: -9, tags: ['vulnerabilidade_ambiental'] }
                ]
            },
            arcano: {
                names: ["Selo de Salum", "Eco do Grim√≥rio", "Cora√ß√£o da Converg√™ncia", "L√°grima de √çris", "Vontade do Arquimago", "Chave do Nexo M√°gico"],
                origins: ["O poder flui de uma linhagem antiga, despertado por um evento catacl√≠smico.", "O portador fez um pacto com uma entidade arcana, recebendo poder em troca de um pre√ßo desconhecido.", "Uma rel√≠quia m√°gica se fundiu com a alma do usu√°rio, concedendo acesso a magias proibidas.", "O portador nasceu durante uma converg√™ncia m√°gica rara, absorvendo energia de m√∫ltiplas dimens√µes."],
                consequences: ["Cada feiti√ßo lan√ßado consome uma pequena parte da alma do usu√°rio.", "O portador atrai constantemente a aten√ß√£o de dem√¥nios e outras entidades malignas.", "A magia corrompe lentamente o corpo f√≠sico, causando muta√ß√µes estranhas.", "O usu√°rio perde gradualmente a capacidade de distinguir entre realidade e ilus√£o."],
                abilities: [
                    { name: "Invoca√ß√£o Elemental", description: "Convoca e controla elementos primordiais como fogo, √°gua, terra e ar.", score: 7, tags: ['elemental', 'invoca√ß√£o', 'versatil'] },
                    { name: "Teletransporte Dimensional", description: "Move-se instantaneamente atrav√©s de portais entre dimens√µes.", score: 8, tags: ['dimensional', 'movimento', 'escape'] },
                    { name: "Necromancia", description: "Controla mortos-vivos e pode drenar energia vital de seres vivos.", score: 9, tags: ['necromancia', 'controle', 'drenagem'] },
                    { name: "Ilus√µes Mentais", description: "Cria ilus√µes t√£o reais que podem causar dano f√≠sico real.", score: 6, tags: ['mental', 'ilus√£o', 'psicol√≥gica'] },
                    { name: "Transmuta√ß√£o", description: "Altera a forma e propriedades de objetos e seres vivos.", score: 7, tags: ['transmuta√ß√£o', 'altera√ß√£o', 'versatil'] },
                    { name: "Barreira Arcana", description: "Cria escudos m√°gicos que podem bloquear ataques f√≠sicos e m√°gicos.", score: 6, tags: ['defensiva', 'prote√ß√£o', 'barreira'] }
                ],
                weaknesses: [
                    { name: "Vulnerabilidade a Ferro Frio", description: "Ferro forjado sem calor anula completamente os poderes m√°gicos.", score: -8, tags: ['vulnerabilidade_material'] },
                    { name: "Exaust√£o M√°gica", description: "Uso excessivo de magia causa fadiga extrema e pode levar ao coma.", score: -6, tags: ['limita√ß√£o_uso'] },
                    { name: "C√≠rculos de Banimento", description: "S√≠mbolos sagrados espec√≠ficos podem prender ou banir o usu√°rio.", score: -7, tags: ['vulnerabilidade_ritual'] },
                    { name: "Depend√™ncia Lunar", description: "Poderes enfraquecem drasticamente durante a lua nova.", score: -5, tags: ['vulnerabilidade_temporal'] }
                ]
            },
            tecnologico: {
                names: ["Interface Neural Qu√¢ntica", "Exoesqueleto Adaptativo", "Nanoenxame Simbi√≥tico", "Reator de Fus√£o Port√°til", "IA Companheira", "Armadura de Plasma"],
                origins: ["Resultado de experimentos militares secretos com tecnologia alien√≠gena recuperada.", "Criado por uma corpora√ß√£o futurista como o pr√≥ximo passo na evolu√ß√£o humana.", "Tecnologia desenvolvida por uma IA superinteligente para seus agentes humanos.", "Equipamento de uma civiliza√ß√£o avan√ßada que chegou √† Terra atrav√©s de um portal dimensional."],
                consequences: ["A tecnologia lentamente substitui partes do corpo humano, questionando o que significa ser humano.", "Sistemas de rastreamento governamentais constantemente monitoram o usu√°rio.", "A depend√™ncia da tecnologia cria vulnerabilidades a ataques cibern√©ticos.", "Atualiza√ß√µes de software podem alterar a personalidade e mem√≥rias do usu√°rio."],
                abilities: [
                    { name: "Hacking Neural", description: "Interfere diretamente com sistemas eletr√¥nicos e mentes cibern√©ticas.", score: 8, tags: ['cibern√©tica', 'controle', 'tecnol√≥gica'] },
                    { name: "For√ßa Amplificada", description: "Exoesqueleto multiplica a for√ßa f√≠sica em at√© 50 vezes.", score: 7, tags: ['f√≠sica', 'amplifica√ß√£o', 'for√ßa'] },
                    { name: "Regenera√ß√£o Nanotecnol√≥gica", description: "Nanobots reparam ferimentos e doen√ßas em tempo real.", score: 8, tags: ['regenera√ß√£o', 'cura', 'nanotecnologia'] },
                    { name: "Proje√ß√£o Hologr√°fica", description: "Cria hologramas s√≥lidos tempor√°rios para combate ou infiltra√ß√£o.", score: 6, tags: ['proje√ß√£o', 'ilus√£o', 'versatil'] },
                    { name: "An√°lise Preditiva", description: "IA calcula probabilidades e prev√™ a√ß√µes inimigas com alta precis√£o.", score: 7, tags: ['an√°lise', 'previs√£o', 'estrat√©gica'] },
                    { name: "Campo de Energia", description: "Gera escudos de energia e rajadas de plasma concentrado.", score: 8, tags: ['energia', 'defensiva', 'ofensiva'] }
                ],
                weaknesses: [
                    { name: "Pulso Eletromagn√©tico", description: "EMPs desabilitam temporariamente todos os sistemas tecnol√≥gicos.", score: -9, tags: ['vulnerabilidade_eletr√¥nica'] },
                    { name: "Sobrecarga de Sistema", description: "Uso intenso causa superaquecimento e falhas cr√≠ticas.", score: -6, tags: ['limita√ß√£o_t√©rmica'] },
                    { name: "Depend√™ncia Energ√©tica", description: "Requer recarga constante, tornando-se in√∫til sem fonte de energia.", score: -7, tags: ['depend√™ncia_energia'] },
                    { name: "V√≠rus Cibern√©tico", description: "Malware especializado pode corromper sistemas e causar comportamento err√°tico.", score: -8, tags: ['vulnerabilidade_software'] }
                ]
            },
            biologico: {
                names: ["Muta√ß√£o Adaptativa", "Simbiose Parasit√°ria", "Evolu√ß√£o Acelerada", "Hibridiza√ß√£o Gen√©tica", "Regenera√ß√£o Celular", "Instinto Primordial"],
                origins: ["Exposi√ß√£o a radia√ß√£o alien√≠gena alterou permanentemente o DNA do portador.", "Infec√ß√£o por um v√≠rus senciente que concede habilidades em troca de coexist√™ncia.", "Experimentos gen√©ticos ilegais combinaram DNA humano com criaturas extintas.", "Muta√ß√£o natural rara que ocorre uma vez a cada milh√£o de nascimentos."],
                consequences: ["O corpo sofre muta√ß√µes constantes, algumas ben√©ficas, outras grotescas.", "Instintos animais gradualmente sobrep√µem a racionalidade humana.", "O sistema imunol√≥gico hiperativo ataca c√©lulas saud√°veis.", "Necessidades alimentares se tornam extremas e espec√≠ficas."],
                abilities: [
                    { name: "Metamorfose Corporal", description: "Altera a forma f√≠sica para se adaptar a diferentes situa√ß√µes.", score: 8, tags: ['transforma√ß√£o', 'adapta√ß√£o', 'f√≠sica'] },
                    { name: "Regenera√ß√£o Extrema", description: "Regenera membros perdidos e se recupera de ferimentos fatais.", score: 9, tags: ['regenera√ß√£o', 'sobreviv√™ncia', 'cura'] },
                    { name: "Sentidos Aprimorados", description: "Vis√£o, audi√ß√£o, olfato e tato amplificados al√©m dos limites humanos.", score: 6, tags: ['sensorial', 'percep√ß√£o', 'detec√ß√£o'] },
                    { name: "Toxinas Naturais", description: "Produz venenos e √°cidos atrav√©s da pele, saliva ou garras.", score: 7, tags: ['toxina', 'ofensiva', 'qu√≠mica'] },
                    { name: "Mimetismo Biol√≥gico", description: "Copia habilidades e caracter√≠sticas de outras formas de vida.", score: 8, tags: ['mimetismo', 'adapta√ß√£o', 'c√≥pia'] },
                    { name: "Controle Feromonal", description: "Influencia comportamento de outros seres atrav√©s de ferom√¥nios.", score: 5, tags: ['controle', 'qu√≠mica', 'influ√™ncia'] }
                ],
                weaknesses: [
                    { name: "Instabilidade Gen√©tica", description: "Muta√ß√µes aleat√≥rias podem causar falhas org√¢nicas cr√≠ticas.", score: -7, tags: ['instabilidade_gen√©tica'] },
                    { name: "Vulnerabilidade a Antibi√≥ticos", description: "Medicamentos comuns podem ser letais devido √† biologia alterada.", score: -6, tags: ['vulnerabilidade_m√©dica'] },
                    { name: "Necessidades Metab√≥licas", description: "Requer consumo massivo de nutrientes espec√≠ficos para manter as habilidades.", score: -5, tags: ['depend√™ncia_nutricional'] },
                    { name: "Rejei√ß√£o Imunol√≥gica", description: "Sistema imunol√≥gico de outros seres reage violentamente √† presen√ßa do usu√°rio.", score: -6, tags: ['rejei√ß√£o_biol√≥gica'] }
                ]
            },
            psiquico: {
                names: ["Mente Coletiva", "Eco Telep√°tico", "Fragmento Ps√≠quico", "Nexus Mental", "Consci√™ncia Expandida", "Resson√¢ncia Cerebral"],
                origins: ["Trauma psicol√≥gico extremo desbloqueou √°reas dormentes do c√©rebro.", "Contato com uma entidade ps√≠quica alien√≠gena deixou uma marca permanente.", "Experimentos com drogas psicoativas abriram portais mentais.", "Nasceu com uma anomalia neurol√≥gica que concede habilidades telep√°ticas."],
                consequences: ["Constantemente bombardeado pelos pensamentos e emo√ß√µes de outros.", "Personalidades m√∫ltiplas se desenvolvem como mecanismo de defesa.", "Dores de cabe√ßa cr√¥nicas e sangramentos nasais frequentes.", "Dificuldade em distinguir entre pensamentos pr√≥prios e alheios."],
                abilities: [
                    { name: "Telepatia", description: "L√™ pensamentos e se comunica mentalmente com outros seres.", score: 7, tags: ['mental', 'comunica√ß√£o', 'leitura'] },
                    { name: "Telecinese", description: "Move objetos com o poder da mente, desde pequenos itens at√© ve√≠culos.", score: 8, tags: ['telecinese', 'movimento', 'for√ßa'] },
                    { name: "Controle Mental", description: "Influencia ou controla completamente as a√ß√µes de outras pessoas.", score: 9, tags: ['controle', 'domina√ß√£o', 'mental'] },
                    { name: "Proje√ß√£o Astral", description: "Separa a consci√™ncia do corpo f√≠sico para explorar outros planos.", score: 6, tags: ['proje√ß√£o', 'espiritual', 'explora√ß√£o'] },
                    { name: "Precogni√ß√£o", description: "Vislumbra eventos futuros atrav√©s de vis√µes e sonhos prof√©ticos.", score: 7, tags: ['temporal', 'previs√£o', 'futuro'] },
                    { name: "Escudo Mental", description: "Protege a mente contra ataques ps√≠quicos e influ√™ncias externas.", score: 6, tags: ['defensiva', 'prote√ß√£o', 'mental'] }
                ],
                weaknesses: [
                    { name: "Sobrecarga Sensorial", description: "Ambientes com muitas mentes causam dor extrema e desorienta√ß√£o.", score: -7, tags: ['sobrecarga_mental'] },
                    { name: "Vulnerabilidade Ps√≠quica", description: "Outros ps√≠quicos podem causar dano mental permanente.", score: -8, tags: ['vulnerabilidade_ps√≠quica'] },
                    { name: "Instabilidade Emocional", description: "Emo√ß√µes intensas de outros afetam drasticamente o estado mental.", score: -6, tags: ['instabilidade_emocional'] },
                    { name: "Depend√™ncia de Concentra√ß√£o", description: "Distra√ß√µes ou ferimentos impedem o uso dos poderes.", score: -5, tags: ['depend√™ncia_concentra√ß√£o'] }
                ]
            }
        };

        const tierConfig = {
            extremo: { name: 'Extremo', minScore: 45, color: '#ef4444' },
            cosmico: { name: 'C√≥smico', minScore: 35, color: '#a855f7' },
            elevado: { name: 'Elevado', minScore: 25, color: '#3b82f6' },
            controlavel: { name: 'Control√°vel', minScore: 15, color: '#06b6d4' },
            baixo: { name: 'Baixo', minScore: 0, color: '#22c55e' }
        };

        // ELEMENTOS DOM
        const generateBtn = document.getElementById('generate-btn');
        const battleBtn = document.getElementById('battle-btn');
        const arenaBattleBtn = document.getElementById('arena-battle-btn');
        const viewToggleBtn = document.getElementById('view-toggle-btn');
        const themeSelector = document.getElementById('theme-selector');
        const resultsContainer = document.getElementById('results-container');
        const generatorView = document.getElementById('generator-view');
        const arenaView = document.getElementById('arena-view');
        const savedPowersContainer = document.getElementById('saved-powers-container');
        const arenaContainer = document.getElementById('arena-container');
        const searchInput = document.getElementById('search-saved');
        const filterBtnContainer = document.getElementById('saved-filters');
        const mainModal = document.getElementById('main-modal');
        const modalContentArea = document.getElementById('modal-content-area');

        // VARI√ÅVEIS GLOBAIS
        let currentlyGeneratedPowers = [null, null];
        let arenaCombatants = [];

        // FUN√á√ïES PRINCIPAIS
        function getRandomElement(array) { return array[Math.floor(Math.random() * array.length)]; }

        function createSinglePower() {
            const themes = Object.keys(allData);
            const selectedTheme = themeSelector.value === 'random' ? getRandomElement(themes) : themeSelector.value;
            const themeData = allData[selectedTheme];
            
            const power = {
                id: Date.now() + Math.random(),
                theme: selectedTheme,
                name: getRandomElement(themeData.names),
                origin: getRandomElement(themeData.origins),
                consequence: getRandomElement(themeData.consequences),
                abilities: [],
                weaknesses: []
            };

            // Selecionar habilidades (3-5)
            const numAbilities = 3 + Math.floor(Math.random() * 3);
            const shuffledAbilities = [...themeData.abilities].sort(() => 0.5 - Math.random());
            power.abilities = shuffledAbilities.slice(0, numAbilities);

            // Selecionar fraquezas (2-3)
            const numWeaknesses = 2 + Math.floor(Math.random() * 2);
            const shuffledWeaknesses = [...themeData.weaknesses].sort(() => 0.5 - Math.random());
            power.weaknesses = shuffledWeaknesses.slice(0, numWeaknesses);

            // Calcular pontua√ß√£o total
            const abilityScore = power.abilities.reduce((sum, ability) => sum + ability.score, 0);
            const weaknessScore = power.weaknesses.reduce((sum, weakness) => sum + Math.abs(weakness.score), 0);
            power.totalScore = Math.max(0, abilityScore - weaknessScore);

            // Determinar tier
            power.tier = Object.entries(tierConfig).find(([key, config]) => power.totalScore >= config.minScore)?.[0] || 'baixo';

            return power;
        }

        function displayPower(power, cardNumber) {
            const card = document.getElementById(`power-card-${cardNumber}`);
            const tierInfo = tierConfig[power.tier];
            
            card.innerHTML = `
                <div class="power-header">
                    <h2 class="power-name">${power.name}</h2>
                    <span class="tier-badge tier-${power.tier}">${tierInfo.name}</span>
                    <div class="power-score">Pontua√ß√£o Total: ${power.totalScore}</div>
                </div>
                
                <div class="power-narrative">
                    <p><strong>Origem:</strong> ${power.origin}</p>
                    <p><strong>Consequ√™ncia:</strong> ${power.consequence}</p>
                </div>
                
                <h3><i class="fas fa-magic"></i> Habilidades</h3>
                <ul>
                    ${power.abilities.map(ability => `
                        <li>
                            <strong>${ability.name} (${ability.score})</strong>
                            ${ability.description}
                        </li>
                    `).join('')}
                </ul>
                
                <h3><i class="fas fa-exclamation-triangle"></i> Fraquezas</h3>
                <ul>
                    ${power.weaknesses.map(weakness => `
                        <li>
                            <strong>${weakness.name} (${weakness.score})</strong>
                            ${weakness.description}
                        </li>
                    `).join('')}
                </ul>
                
                <div class="card-footer">
                    <button class="action-icon save-btn" data-index="${cardNumber - 1}">
                        <i class="fas fa-save"></i>
                    </button>
                    <button class="action-icon share-btn" data-index="${cardNumber - 1}">
                        <i class="fas fa-share-alt"></i>
                    </button>
                </div>
            `;
            
            card.style.borderLeftColor = tierInfo.color;
        }

        function savePower(index) {
            const power = currentlyGeneratedPowers[index];
            if (!power) return;
            
            const savedPowers = JSON.parse(localStorage.getItem('savedCosmicPowers') || '[]');
            
            // Verificar se j√° existe
            if (savedPowers.some(p => p.id === power.id)) {
                alert('Este poder j√° foi salvo!');
                return;
            }
            
            savedPowers.push(power);
            localStorage.setItem('savedCosmicPowers', JSON.stringify(savedPowers));
            renderSavedPowers();
        }

        function deletePower(powerId) {
            if (!confirm('Tem certeza que deseja excluir este poder?')) return;
            
            const savedPowers = JSON.parse(localStorage.getItem('savedCosmicPowers') || '[]');
            const filteredPowers = savedPowers.filter(p => p.id != powerId);
            localStorage.setItem('savedCosmicPowers', JSON.stringify(filteredPowers));
            renderSavedPowers();
            renderArena();
        }

        function renderSavedPowers(searchTerm = '', filterTier = 'all') {
            const savedPowers = JSON.parse(localStorage.getItem('savedCosmicPowers') || '[]');
            
            if (savedPowers.length === 0) {
                savedPowersContainer.innerHTML = `
                    <div class="saved-powers-empty">
                        <i class="fas fa-magic" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                        <p>Nenhum poder salvo ainda.</p>
                        <p>Gere poderes e clique no √≠cone de salvar para come√ßar sua cole√ß√£o!</p>
                    </div>
                `;
                return;
            }
            
            let filteredPowers = savedPowers;
            
            // Filtrar por busca
            if (searchTerm) {
                filteredPowers = filteredPowers.filter(power => 
                    power.name.toLowerCase().includes(searchTerm.toLowerCase())
                );
            }
            
            // Filtrar por tier
            if (filterTier !== 'all') {
                filteredPowers = filteredPowers.filter(power => power.tier === filterTier);
            }
            
            if (filteredPowers.length === 0) {
                savedPowersContainer.innerHTML = `
                    <div class="saved-powers-empty">
                        <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                        <p>Nenhum poder encontrado com os filtros aplicados.</p>
                    </div>
                `;
                return;
            }
            
            savedPowersContainer.innerHTML = filteredPowers.map(power => {
                const tierInfo = tierConfig[power.tier];
                return `
                    <div class="saved-power-card" data-id="${power.id}" style="border-left-color: ${tierInfo.color}">
                        <div class="info">
                            <div class="name">${power.name}</div>
                            <div class="tier-info">
                                <span class="tier-badge tier-${power.tier}">${tierInfo.name}</span>
                                <span style="margin-left: 0.5rem;">Pontua√ß√£o: ${power.totalScore}</span>
                            </div>
                        </div>
                        <button class="view-details-btn">
                            <i class="fas fa-eye"></i> Ver Detalhes
                        </button>
                        <button class="delete-btn" data-id="${power.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
            }).join('');
        }

        function renderArena() {
            const savedPowers = JSON.parse(localStorage.getItem('savedCosmicPowers') || '[]');
            
            if (savedPowers.length === 0) {
                arenaContainer.innerHTML = `
                    <div class="saved-powers-empty">
                        <i class="fas fa-shield-alt" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                        <p>Voc√™ precisa de pelo menos 2 poderes salvos para usar a Arena.</p>
                        <p>Volte ao gerador e salve alguns poderes primeiro!</p>
                    </div>
                `;
                return;
            }
            
            if (savedPowers.length < 2) {
                arenaContainer.innerHTML = `
                    <div class="saved-powers-empty">
                        <i class="fas fa-shield-alt" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                        <p>Voc√™ precisa de pelo menos 2 poderes salvos para batalhar na Arena.</p>
                        <p>Salve mais um poder para desbloquear as batalhas!</p>
                    </div>
                `;
                return;
            }
            
            arenaContainer.innerHTML = savedPowers.map(power => {
                const tierInfo = tierConfig[power.tier];
                return `
                    <div class="saved-power-card" data-id="${power.id}" style="border-left-color: ${tierInfo.color}">
                        <div class="info">
                            <div class="name">${power.name}</div>
                            <div class="tier-info">
                                <span class="tier-badge tier-${power.tier}">${tierInfo.name}</span>
                                <span style="margin-left: 0.5rem;">Pontua√ß√£o: ${power.totalScore}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function showDetailModal(power) {
            const tierInfo = tierConfig[power.tier];
            
            modalContentArea.innerHTML = `
                <span class="close-btn">&times;</span>
                <div class="power-header">
                    <h2 class="power-name">${power.name}</h2>
                    <span class="tier-badge tier-${power.tier}">${tierInfo.name}</span>
                    <div class="power-score">Pontua√ß√£o Total: ${power.totalScore}</div>
                </div>
                
                <div class="power-narrative">
                    <p><strong>Tema:</strong> ${power.theme.charAt(0).toUpperCase() + power.theme.slice(1)}</p>
                    <p><strong>Origem:</strong> ${power.origin}</p>
                    <p><strong>Consequ√™ncia:</strong> ${power.consequence}</p>
                </div>
                
                <h3><i class="fas fa-magic"></i> Habilidades</h3>
                <ul>
                    ${power.abilities.map(ability => `
                        <li>
                            <strong>${ability.name} (${ability.score})</strong>
                            ${ability.description}
                        </li>
                    `).join('')}
                </ul>
                
                <h3><i class="fas fa-exclamation-triangle"></i> Fraquezas</h3>
                <ul>
                    ${power.weaknesses.map(weakness => `
                        <li>
                            <strong>${weakness.name} (${weakness.score})</strong>
                            ${weakness.description}
                        </li>
                    `).join('')}
                </ul>
                
                <div class="card-footer">
                    <button class="action-icon share-btn" data-id="${power.id}">
                        <i class="fas fa-share-alt"></i>
                    </button>
                </div>
            `;
            
            mainModal.classList.add('visible');
        }

        function sharePower(power) {
            if (!power) return;
            
            const shareText = `üåü ${power.name} üåü\n\n` +
                `Tier: ${tierConfig[power.tier].name}\n` +
                `Pontua√ß√£o: ${power.totalScore}\n\n` +
                `${power.origin}\n\n` +
                `Gerado no Nexus C√≥smico - O universo em suas m√£os!`;
            
            if (navigator.share) {
                navigator.share({
                    title: `Poder: ${power.name}`,
                    text: shareText
                });
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    alert('Poder copiado para a √°rea de transfer√™ncia!');
                });
            }
        }

        function startBattle(power1, power2) {
            const battleResult = simulateBattle(power1, power2);
            showBattleModal(power1, power2, battleResult);
        }

        function simulateBattle(power1, power2) {
            const rounds = [];
            let score1 = power1.totalScore;
            let score2 = power2.totalScore;
            
            // Simular 3-5 rounds de batalha
            const numRounds = 3 + Math.floor(Math.random() * 3);
            
            for (let i = 0; i < numRounds; i++) {
                const ability1 = getRandomElement(power1.abilities);
                const ability2 = getRandomElement(power2.abilities);
                
                const effectiveness1 = ability1.score + Math.floor(Math.random() * 5) - 2;
                const effectiveness2 = ability2.score + Math.floor(Math.random() * 5) - 2;
                
                let roundWinner;
                let description;
                
                if (effectiveness1 > effectiveness2) {
                    roundWinner = power1.name;
                    score2 -= Math.floor(effectiveness1 / 2);
                    description = `${power1.name} usa ${ability1.name} contra ${ability2.name} de ${power2.name}!`;
                } else if (effectiveness2 > effectiveness1) {
                    roundWinner = power2.name;
                    score1 -= Math.floor(effectiveness2 / 2);
                    description = `${power2.name} usa ${ability2.name} contra ${ability1.name} de ${power1.name}!`;
                } else {
                    roundWinner = 'Empate';
                    description = `${ability1.name} e ${ability2.name} se chocam em um empate √©pico!`;
                }
                
                rounds.push({
                    round: i + 1,
                    description,
                    winner: roundWinner,
                    score1: Math.max(0, score1),
                    score2: Math.max(0, score2)
                });
                
                if (score1 <= 0 || score2 <= 0) break;
            }
            
            const finalWinner = score1 > score2 ? power1.name : score2 > score1 ? power2.name : 'Empate';
            
            return {
                rounds,
                winner: finalWinner,
                finalScore1: Math.max(0, score1),
                finalScore2: Math.max(0, score2)
            };
        }

        function showBattleModal(power1, power2, battleResult) {
            modalContentArea.innerHTML = `
                <span class="close-btn">&times;</span>
                <h2>‚öîÔ∏è Resultado da Batalha ‚öîÔ∏è</h2>
                <div style="display: flex; justify-content: space-between; margin: 2rem 0;">
                    <div style="text-align: center;">
                        <h3>${power1.name}</h3>
                        <span class="tier-badge tier-${power1.tier}">${tierConfig[power1.tier].name}</span>
                        <div>Pontua√ß√£o Final: ${battleResult.finalScore1}</div>
                    </div>
                    <div style="text-align: center; font-size: 2rem;">VS</div>
                    <div style="text-align: center;">
                        <h3>${power2.name}</h3>
                        <span class="tier-badge tier-${power2.tier}">${tierConfig[power2.tier].name}</span>
                        <div>Pontua√ß√£o Final: ${battleResult.finalScore2}</div>
                    </div>
                </div>
                
                <div style="text-align: center; margin: 2rem 0;">
                    <h2 style="color: ${battleResult.winner === 'Empate' ? '#f9d423' : 'var(--success-color)'};">
                        ${battleResult.winner === 'Empate' ? 'ü§ù EMPATE √âPICO!' : `üèÜ ${battleResult.winner.toUpperCase()} VENCE!`}
                    </h2>
                </div>
                
                <div id="battle-log-container">
                    <h3>üìú Log da Batalha</h3>
                    <ul id="battle-log-list">
                        ${battleResult.rounds.map(round => `
                            <li>
                                <strong>Round ${round.round}:</strong> ${round.description}
                                <br><small>Pontua√ß√µes: ${power1.name} (${round.score1}) vs ${power2.name} (${round.score2})</small>
                            </li>
                        `).join('')}
                    </ul>
                </div>
            `;
            
            mainModal.classList.add('visible');
        }

        function populateThemeSelector() {
            const themes = [
                { value: 'random', label: 'Aleat√≥rio' },
                { value: 'cosmico', label: 'C√≥smico' },
                { value: 'arcano', label: 'Arcano' },
                { value: 'tecnologico', label: 'Tecnol√≥gico' },
                { value: 'biologico', label: 'Biol√≥gico' },
                { value: 'psiquico', label: 'Ps√≠quico' }
            ];
            
            themeSelector.innerHTML = themes.map(theme => 
                `<option value="${theme.value}">${theme.label}</option>`
            ).join('');
        }
        
        function populateFilterButtons() {
            Object.values(tierConfig).reverse().forEach(tier => {
                const btn = document.createElement('button');
                btn.className = 'filter-btn';
                btn.dataset.filter = tier.name.toLowerCase();
                btn.textContent = tier.name;
                filterBtnContainer.appendChild(btn);
            });
        }

        // EVENT LISTENERS
        generateBtn.addEventListener('click', () => {
            currentlyGeneratedPowers[0] = createSinglePower();
            currentlyGeneratedPowers[1] = createSinglePower();
            displayPower(currentlyGeneratedPowers[0], 1);
            displayPower(currentlyGeneratedPowers[1], 2);
            resultsContainer.classList.add('visible');
            battleBtn.style.display = 'inline-block';
        });

        battleBtn.addEventListener('click', () => startBattle(currentlyGeneratedPowers[0], currentlyGeneratedPowers[1]));
        arenaBattleBtn.addEventListener('click', () => {
            if (arenaCombatants.length === 2) {
                startBattle(arenaCombatants[0], arenaCombatants[1]);
            }
        });
        
        viewToggleBtn.addEventListener('click', () => {
            generatorView.classList.toggle('hidden');
            arenaView.classList.toggle('hidden');
            if (!arenaView.classList.contains('hidden')) {
                viewToggleBtn.innerHTML = `<i class="fas fa-dice-d20"></i> Voltar ao Gerador`;
                renderArena();
                arenaCombatants = [];
                arenaBattleBtn.disabled = true;
            } else {
                viewToggleBtn.innerHTML = `<i class="fas fa-shield-alt"></i> Ir para Arena`;
            }
        });
        
        mainModal.addEventListener('click', (event) => {
            if (event.target === mainModal || event.target.closest('.close-btn')) {
                mainModal.classList.remove('visible');
            }
        });

        document.addEventListener('click', (event) => {
            const saveBtn = event.target.closest('.save-btn');
            if(saveBtn) {
                savePower(saveBtn.dataset.index);
                saveBtn.innerHTML = `<i class="fas fa-check"></i>`;
                saveBtn.disabled = true;
            }
            
            const shareBtn = event.target.closest('.share-btn');
            if(shareBtn) {
                const index = shareBtn.dataset.index;
                const id = shareBtn.dataset.id;
                let powerToShare = null;
                if (index) {
                    powerToShare = currentlyGeneratedPowers[index];
                } else if (id) {
                    const savedPowers = JSON.parse(localStorage.getItem('savedCosmicPowers') || '[]');
                    powerToShare = savedPowers.find(p => p.id == id);
                }
                sharePower(powerToShare);
            }
        });
        
        savedPowersContainer.addEventListener('click', (event) => {
            const deleteBtn = event.target.closest('.delete-btn');
            if (deleteBtn) {
                event.stopPropagation();
                deletePower(deleteBtn.dataset.id);
                return;
            }
            
            const viewDetailsBtn = event.target.closest('.view-details-btn');
            if (viewDetailsBtn) {
                event.stopPropagation();
                const card = viewDetailsBtn.closest('.saved-power-card');
                const savedPowers = JSON.parse(localStorage.getItem('savedCosmicPowers') || '[]');
                const power = savedPowers.find(p => p.id == card.dataset.id);
                if (power) showDetailModal(power);
                return;
            }
            
            const card = event.target.closest('.saved-power-card');
            if (card) {
                const savedPowers = JSON.parse(localStorage.getItem('savedCosmicPowers') || '[]');
                const power = savedPowers.find(p => p.id == card.dataset.id);
                if (power) showDetailModal(power);
            }
        });
        
        arenaContainer.addEventListener('click', (event) => {
            const card = event.target.closest('.saved-power-card');
            if (!card) return;
            
            const powerId = card.dataset.id;
            const savedPowers = JSON.parse(localStorage.getItem('savedCosmicPowers') || '[]');
            const power = savedPowers.find(p => p.id == powerId);
            
            if (card.classList.contains('selected')) {
                card.classList.remove('selected');
                arenaCombatants = arenaCombatants.filter(p => p.id !== power.id);
            } else {
                if (arenaCombatants.length < 2) {
                    card.classList.add('selected');
                    arenaCombatants.push(power);
                }
            }
            arenaBattleBtn.disabled = arenaCombatants.length !== 2;
        });
        
        searchInput.addEventListener('input', () => {
            renderSavedPowers(searchInput.value, document.querySelector('.filter-btn.active').dataset.filter);
        });
        
        filterBtnContainer.addEventListener('click', (event) => {
            if (event.target.classList.contains('filter-btn')) {
                document.querySelector('.filter-btn.active').classList.remove('active');
                event.target.classList.add('active');
                renderSavedPowers(searchInput.value, event.target.dataset.filter);
            }
        });

        // INICIALIZA√á√ÉO
        document.addEventListener('DOMContentLoaded', () => {
            populateThemeSelector();
            populateFilterButtons();
            renderSavedPowers();
        });

    </script>
</body>
</html>

